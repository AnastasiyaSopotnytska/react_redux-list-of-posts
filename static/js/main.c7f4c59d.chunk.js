(this["webpackJsonpreact_redux-list-of-posts"]=this["webpackJsonpreact_redux-list-of-posts"]||[]).push([[0],{16:function(t,e,n){},17:function(t,e,n){},19:function(t,e,n){},20:function(t,e,n){},21:function(t,e,n){"use strict";n.r(e);var c=n(5),s=n.n(c),o=n(2),a=n(3),i=n(0),r=(n(16),"https://mate.academy/students-api"),u=n(4),l=Object(u.b)("SET_USERS"),j=Object(u.b)("SET_POST"),d=Object(u.b)("SET_COMMENTS"),b=Object(u.b)("ADD_COMMENT"),m=Object(u.c)({posts:[],users:[],comments:[]},(function(t){t.addCase(l,(function(t,e){t.users=e.payload})).addCase(j,(function(t,e){t.posts=e.payload})).addCase(d,(function(t,e){t.comments=e.payload})).addCase(b,(function(t,e){t.comments.push(e.payload)}))})),O=Object(u.a)({reducer:m}),h=function(t){return t.users},f=function(t){return t.posts},p=function(t){return t.comments},x=(n(17),n(1)),_=function(t){var e=t.userSelect,n=t.setPostId,c=Object(o.b)(),s=Object(o.c)(f),u=Object(i.useState)(0),l=Object(a.a)(u,2),d=l[0],b=l[1];return Object(i.useEffect)((function(){var t;(t=e,"0"===t?fetch("".concat(r,"/posts")).then((function(t){return t.json()})):fetch("".concat(r,"/posts?userId=").concat(t)).then((function(t){return t.json()}))).then((function(t){return c(j(t))}))}),[e]),Object(x.jsxs)("div",{className:"PostsList",children:[Object(x.jsx)("h2",{children:"Posts:"}),Object(x.jsx)("ul",{className:"PostsList__list",children:s.map((function(t){return Object(x.jsxs)("li",{className:"PostsList__item","data-cy":"postDetails",children:[Object(x.jsxs)("div",{children:[Object(x.jsx)("b",{children:"[User #".concat(t.userId,"]: ")}),t.title]}),Object(x.jsx)("button",{type:"button",className:"PostsList__button button",onClick:function(){t.id===d?(b(0),n(0)):(b(t.id),n(t.id))},children:t.id===d?"Close":"Open"})]},t.id)}))})]})},N=function(t){return fetch("".concat(r,"/comments?postId=").concat(t)).then((function(t){return t.json()}))},v=(n(19),function(t){var e=t.postId,n=Object(i.useState)(""),c=Object(a.a)(n,2),s=c[0],u=c[1],l=Object(i.useState)(""),j=Object(a.a)(l,2),d=j[0],m=j[1],O=Object(i.useState)(""),h=Object(a.a)(O,2),f=h[0],p=h[1],_=Object(o.b)();return Object(x.jsxs)("form",{className:"NewCommentForm",onSubmit:function(t){t.preventDefault();var n,c={id:e+1e3,postId:e,name:s,email:d,body:f,createdAt:Date(),updatedAt:Date()};(n=c,fetch("".concat(r,"/comments"),{method:"POST",headers:{"Content-type":"application/json; charset=UTF-8"},body:JSON.stringify({comment:n})}).then((function(t){return t.json()}))).then((function(){return N(e).then((function(t){return _(b(t))}))})),u(""),m(""),p("")},children:[Object(x.jsx)("div",{className:"form-field",children:Object(x.jsx)("input",{type:"text",name:"name",placeholder:"Your name",className:"NewCommentForm__input",value:s,onChange:function(t){u(t.target.value)}})}),Object(x.jsx)("div",{className:"form-field",children:Object(x.jsx)("input",{type:"email",name:"email",placeholder:"Your email",className:"NewCommentForm__input",value:d,onChange:function(t){m(t.target.value)}})}),Object(x.jsx)("div",{className:"form-field",children:Object(x.jsx)("textarea",{name:"body",placeholder:"Type comment here",className:"NewCommentForm__input",value:f,onChange:function(t){p(t.target.value)}})}),Object(x.jsx)("button",{type:"submit",className:"NewCommentForm__submit-button button",children:"Add a comment"})]})}),S=(n(20),function(t){var e=t.postId,n=Object(o.b)(),c=Object(o.c)(p),s=Object(i.useState)(!1),u=Object(a.a)(s,2),l=u[0],j=u[1],b=Object(i.useState)(null),m=Object(a.a)(b,2),O=m[0],h=m[1];Object(i.useEffect)((function(){N(e).then((function(t){n(d(t))})),function(t){return fetch("".concat(r,"/posts/:").concat(t)).then((function(t){return t.json()}))}(e.toString()).then((function(t){return h(t)}))}),[e]);var f=function(t){!function(t){fetch("".concat(r,"/comments/").concat(t),{method:"DELETE"})}(t),N(e).then((function(t){n(d(t))}))};return Object(x.jsxs)("div",{className:"PostDetails",children:[Object(x.jsx)("h2",{children:"Post details:"}),Object(x.jsx)("section",{className:"PostDetails__post",children:Object(x.jsx)("p",{children:null===O||void 0===O?void 0:O.title})}),Object(x.jsxs)("section",{className:"PostDetails__comments",children:[Object(x.jsx)("button",{type:"button",className:"button",onClick:function(){return j(!l)},children:l?"Shown ".concat(c.length," comments"):"Hide ".concat(c.length," comments")}),!l&&Object(x.jsx)("ul",{className:"PostDetails__list",children:c.map((function(t){return Object(x.jsxs)("li",{className:"PostDetails__list-item",children:[Object(x.jsx)("button",{type:"button",className:"PostDetails__remove-button button",onClick:function(){return f(t.id)},children:"X"}),Object(x.jsx)("p",{children:t.body})]},t.id)}))})]}),Object(x.jsx)("section",{children:Object(x.jsx)("div",{className:"PostDetails__form-wrapper",children:O&&Object(x.jsx)(v,{postId:null===O||void 0===O?void 0:O.id})})})]})}),y=function(){var t=Object(o.b)(),e=Object(o.c)(h),n=Object(i.useState)("0"),c=Object(a.a)(n,2),s=c[0],u=c[1],j=Object(i.useState)(0),d=Object(a.a)(j,2),b=d[0],m=d[1];return Object(i.useEffect)((function(){fetch("".concat(r,"/users")).then((function(t){return t.json()})).then((function(e){return t(l(e))}))}),[]),Object(x.jsxs)("div",{className:"App",children:[Object(x.jsx)("header",{className:"App__header",children:Object(x.jsxs)("label",{children:["Select a user: \xa0",Object(x.jsxs)("select",{className:"App__user-selector",value:s,onChange:function(t){return u(t.target.value)},children:[Object(x.jsx)("option",{value:"0",children:"All users"}),e.map((function(t){return Object(x.jsx)("option",{value:t.id,children:t.name},t.id)}))]})]})}),Object(x.jsxs)("main",{className:"App__main",children:[Object(x.jsx)("div",{className:"App__sidebar",children:Object(x.jsx)(_,{userSelect:s,setPostId:m})}),Object(x.jsx)("div",{className:"App__content",children:0!==b?Object(x.jsx)(S,{postId:b}):Object(x.jsx)("p",{children:"No selected post"})})]})]})},C=function(){return Object(x.jsx)(o.a,{store:O,children:Object(x.jsx)(y,{})})};s.a.render(Object(x.jsx)(C,{}),document.getElementById("root"))}},[[21,1,2]]]);
//# sourceMappingURL=main.c7f4c59d.chunk.js.map